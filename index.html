<!doctype html>
<html>
    <head>
        <meta charset="utf-8">
        <link rel="shortcut icon" type="image/png" href="favicon.png"/>
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
        <title>Šibačka | Veľká noc v čase COVID</title>
        <meta name="description" content="Vyšibte svoju známu pomocou prvej online šibačky">
    </head>
    <body>
        <div id="fb_pic" class="fb_pic" style="background: red;width: 60px;height: 60px;position: absolute;top: 10px;left: 10px;border-radius: 50%;border: 2px solid black;">
            <img alt="profile_pic" id="fb_pic_img" style="width: 100%;height: 100%; border-radius: 50%;">
        </div>
        <div id="fb-root"></div>
        <script async defer crossorigin="anonymous" src="https://connect.facebook.net/sk_SK/sdk.js#xfbml=1&version=v6.0&appId=2866677673420258&autoLogAppEvents=1"></script>
        <div id="fb-login-button" class="fb-login-button" data-width="" data-size="large" data-button-type="login_with" data-layout="rounded" data-auto-logout-link="false" data-use-continue-as="true" data-scope="user_gender,public_profile" data-onlogin='myFbLogin();'></div>
        <script>
          window.fbAsyncInit = function() {
            FB.init({
              appId      : '2866677673420258',
              cookie     : true,
              xfbml      : true,
              version    : 'v6.0'
            });
              
            FB.AppEvents.logPageView();   
          };

          (function(d, s, id){
             var js, fjs = d.getElementsByTagName(s)[0];
             if (d.getElementById(id)) {return;}
             js = d.createElement(s); js.id = id;
             js.src = "https://connect.facebook.net/en_US/sdk.js";
             fjs.parentNode.insertBefore(js, fjs);
           }(document, 'script', 'facebook-jssdk'));
        </script>
        <script>
        function myFbLogin() {
            console.log("myFbLogin starts");
            //FB.login(function(response) {
            FB.getLoginStatus(function(response) {
                console.log(response);
                if (response.authResponse) {
                    console.log('Welcome!  Fetching your information.... ');
                    let fbID;
                    FB.api('/me', function(response) {
                        console.log('Good to see you, ' + response.name + '.');
                        fbID = response.id;

                        FB.api(
                            '/'+fbID+'/picture',
                            'GET',
                            {"redirect":"false","type":"large","width":"400","height":"400"},
                            function(response) {
                                console.log(response);
                                // Insert your code here
                                if (response.data.url) {
                                    fb_img = document.getElementById("fb_pic_img");
                                    fb_img.src = response.data.url;
                                    console.log("should set img src");
                                }
                        });
                    });

                    document.getElementById("fb-login-button").style.display = "none";
                } else {
                    console.log('User cancelled login or did not fully authorize.');
                }
            });

            // FB.login();
            // let fbID;
            // FB.api('/me', function(response) {
            //     fbID=response.id;
            //     console.log('Successful login for: ' + response.name);
            // });

            // console.log(fbID);

            // FB.api(
            //     '/'+fbID+'/picture',
            //     'GET',
            //     {"redirect":"false","type":"large","width":"400","height":"400"},
            //     function(response) {
            //         console.log(response);
            //         // Insert your code here
            //         if (response.data.url) {
            //             fb_img = document.getElementById("fb_pic_img");
            //             fb_img.src = response.data.url;
            //             console.log("should set img src");
            //         }
            //     });
        }

        function getData() {
            const userAction = async () => {
                const response = await fetch('http://example.com/movies.json', {
                    method: 'POST',
                    body: myBody, // string or object
                    headers: {
                        'Content-Type': 'application/json'
                    }
                });
                const myJson = await response.json(); //extract JSON from the http response
                // do something with myJson
            }
        }
        </script>
        <script src="pixi.js"></script>
        <script>
            usePng8=false;
        </script>
        <script src="go.js"></script>
        <style>
        body {
            background: url("assets/BGtile.jpg");
            margin: 0;
            padding: 0;
            overflow: hidden;
        }
        canvas {
            margin: 0;
            padding: 0;
        }
        #fb_pic
        {
            background: red;
            width: 60px;
            height: 60px;
            position: absolute;
            top: 10px;
            left: 10px;
            border-radius: 50%;
            border: 2px solid black;
        }
        #profile_pic
        {
            width: 100%;
            height: 100%;
            border-radius: 50%;
        }
        #fb-login-button
        {
            position: absolute;
            top: 90px;
            left: 10px;
        }
        </style>
    </body>
</html>